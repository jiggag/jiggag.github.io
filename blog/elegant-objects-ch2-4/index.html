<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.2222873932a2af5f300c.css" data-identity="gatsby-global-css">*{font-family:Nanum Gothic!important}:root{--surface:silver;--content:#e2e2e2;--button-highlight:#fff;--button-face:#dfdfdf;--button-shadow:grey;--window-frame:#0a0a0a;--dialog-blue:navy;--dialog-blue-light:#1084d0;--dialog-gray:grey;--dialog-gray-light:#b5b5b5;--link-blue:#00f;--element-spacing:8px;--border-width:1px;--border-raised-outer:inset -1px -1px var(--window-frame),inset 1px 1px var(--button-highlight);--border-raised-inner:inset -2px -2px var(--button-shadow),inset 2px 2px var(--button-face);--border-sunken-outer:inset -1px -1px var(--button-highlight),inset 1px 1px var(--window-frame);--border-sunken-inner:inset -2px -2px var(--button-face),inset 2px 2px var(--button-shadow);--border-window-outer:inset -1px -1px var(--window-frame),inset 1px 1px var(--button-face);--border-window-inner:inset -2px -2px var(--button-shadow),inset 2px 2px var(--button-highlight)}body{margin:0}pre{background:var(--button-highlight);box-shadow:var(--border-sunken-outer),var(--border-sunken-inner);display:block;margin:4px 0;padding:var(--element-spacing)}pre code{background:unset;color:unset;font-size:12px}code{background:#0000ff95;border-radius:10px;color:#fff;font-size:14px;padding:0 6px}a{color:var(--link-blue);text-decoration:none}.window{background:var(--surface);box-shadow:var(--border-window-outer),var(--border-window-inner);height:100vh;margin:auto;max-width:500px}.window-container{display:flex;flex-direction:column;height:100%}.window-body{flex:1 1;margin:0 0 0 var(--element-spacing);overflow:auto;padding-right:var(--element-spacing)}.title-bar{align-items:center;background:linear-gradient(150deg,var(--dialog-blue),var(--dialog-blue-light));display:flex;justify-content:space-between;margin:3px 3px 0;padding:2px var(--element-spacing)}.title-bar .title{color:#fff;font-size:24px;margin:0;text-decoration:none}.title-bar-controls{display:flex}.title-bar-controls button{display:block;min-height:14px;min-width:16px;padding:0}.title-bar-controls button[aria-label=Close]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjciIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCA4IDciPjxwYXRoIGZpbGw9IiMwMDAiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTAgMGgydjFoMXYxaDJWMWgxVjBoMnYxSDd2MUg2djFINXYxaDF2MWgxdjFoMXYxSDZWNkg1VjVIM3YxSDJ2MUgwVjZoMVY1aDFWNGgxVjNIMlYySDFWMUgwVjBaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=);background-position:top 5px left 5px;background-repeat:no-repeat;height:19px;margin-left:2px;width:20px}.title-bar-text{color:#fff;font-weight:700;letter-spacing:0;margin-right:24px}.blog-post-container{background:var(--content);box-shadow:var(--border-sunken-outer),var(--border-sunken-inner);margin:var(--element-spacing) 0 0 0;overflow-x:scroll;padding:var(--element-spacing)}.blog-post-content h1,h2{font-size:20px}.blog-post-content h3,h4{font-size:16px}.blog-post-content ul{padding-left:20px}.home-post-title{box-shadow:var(--border-sunken-outer),var(--border-sunken-inner);margin:var(--element-spacing) 0;padding:var(--element-spacing)}.home-post-title p{font-size:12px;margin:4px 0}.footer{align-items:center;display:flex;padding:12px 15px}.footer .footer-label{align-self:flex-end;font-size:12px;width:100%}button{background:var(--surface);border:none;border-radius:0;box-shadow:var(--border-raised-outer),var(--border-raised-inner);box-sizing:border-box;min-height:23px;min-width:75px;padding:0 12px}button:not(:disabled):active{box-shadow:var(--border-sunken-outer),var(--border-sunken-inner);padding:2px 3px 0 13px}@media (not(hover)){button:not(:disabled):hover{box-shadow:var(--border-sunken-outer),var(--border-sunken-inner)}}button:focus{outline:1px dotted #000;outline-offset:-4px}button::-moz-focus-inner{border:0}::-webkit-scrollbar{width:16px}::-webkit-scrollbar:horizontal{height:17px}::-webkit-scrollbar-corner{background:var(--button-face)}::-webkit-scrollbar-track{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyIiBoZWlnaHQ9IjIiIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCAyIDIiPjxwYXRoIGZpbGw9InNpbHZlciIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2MWgxdjFoMVYxSDFWMFoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjxwYXRoIGZpbGw9IiNmZmYiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTIgMEgxdjFIMHYxaDFWMWgxVjBaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}::-webkit-scrollbar-thumb{background-color:var(--button-face);box-shadow:var(--border-raised-outer),var(--border-raised-inner)}::-webkit-scrollbar-button:horizontal:end:increment,::-webkit-scrollbar-button:horizontal:start:decrement,::-webkit-scrollbar-button:vertical:end:increment,::-webkit-scrollbar-button:vertical:start:decrement{display:block}::-webkit-scrollbar-button:vertical:start{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNyIgZmlsbD0ibm9uZSIgdmlld0JveD0iMCAwIDE2IDE3Ij48cGF0aCBmaWxsPSIjREZERkRGIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNSAwSDB2MTZoMVYxaDE0VjBaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48cGF0aCBmaWxsPSIjZmZmIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yIDFIMXYxNGgxVjJoMTJWMUgyWiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTYgMTdIMHYtMWgxNVYwaDF2MTdaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48cGF0aCBmaWxsPSJncmF5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNSAxaC0xdjE0SDF2MWgxNFYxWiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHJlY3Qgd2lkdGg9IjEyIiBoZWlnaHQ9IjEzIiB4PSIyIiB5PSIyIiBmaWxsPSJzaWx2ZXIiLz48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04IDZIN3YxSDZ2MUg1djFINHYxaDdWOWgtMVY4SDlWN0g4VjZaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=);height:17px}::-webkit-scrollbar-button:vertical:end{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNyIgZmlsbD0ibm9uZSIgdmlld0JveD0iMCAwIDE2IDE3Ij48cGF0aCBmaWxsPSIjREZERkRGIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNSAwSDB2MTZoMVYxaDE0VjBaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48cGF0aCBmaWxsPSIjZmZmIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yIDFIMXYxNGgxVjJoMTJWMUgyWiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTYgMTdIMHYtMWgxNVYwaDF2MTdaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48cGF0aCBmaWxsPSJncmF5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNSAxaC0xdjE0SDF2MWgxNFYxWiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHJlY3Qgd2lkdGg9IjEyIiBoZWlnaHQ9IjEzIiB4PSIyIiB5PSIyIiBmaWxsPSJzaWx2ZXIiLz48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMSA2SDR2MWgxdjFoMXYxaDF2MWgxVjloMVY4aDFWN2gxVjZaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=);height:17px}::-webkit-scrollbar-button:horizontal:start{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNyIgZmlsbD0ibm9uZSIgdmlld0JveD0iMCAwIDE2IDE3Ij48cGF0aCBmaWxsPSIjREZERkRGIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNSAwSDB2MTZoMVYxaDE0VjBaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48cGF0aCBmaWxsPSIjZmZmIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yIDFIMXYxNGgxVjJoMTJWMUgyWiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTYgMTdIMHYtMWgxNVYwaDF2MTdaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48cGF0aCBmaWxsPSJncmF5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNSAxaC0xdjE0SDF2MWgxNFYxWiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHJlY3Qgd2lkdGg9IjEyIiBoZWlnaHQ9IjEzIiB4PSIyIiB5PSIyIiBmaWxsPSJzaWx2ZXIiLz48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik05IDRIOHYxSDd2MUg2djFINXYxaDF2MWgxdjFoMXYxaDFWNFoiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==);width:16px}::-webkit-scrollbar-button:horizontal:end{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNyIgZmlsbD0ibm9uZSIgdmlld0JveD0iMCAwIDE2IDE3Ij48cGF0aCBmaWxsPSIjREZERkRGIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNSAwSDB2MTZoMVYxaDE0VjBaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48cGF0aCBmaWxsPSIjZmZmIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0yIDFIMXYxNGgxVjJoMTJWMUgyWiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHBhdGggZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTYgMTdIMHYtMWgxNVYwaDF2MTdaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48cGF0aCBmaWxsPSJncmF5IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xNSAxaC0xdjE0SDF2MWgxNFYxWiIgY2xpcC1ydWxlPSJldmVub2RkIi8+PHJlY3Qgd2lkdGg9IjEyIiBoZWlnaHQ9IjEzIiB4PSIyIiB5PSIyIiBmaWxsPSJzaWx2ZXIiLz48cGF0aCBmaWxsPSIjMDAwIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03IDRINnY3aDF2LTFoMVY5aDFWOGgxVjdIOVY2SDhWNUg3VjRaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=);width:16px}</style><meta name="generator" content="Gatsby 4.1.4"/><title data-react-helmet="true">유지보수를 위해 문서 보다 테스트 코드를 작성하자 | JIGGAG</title><meta data-react-helmet="true" name="description" content="직각어깨를 꿈꾸는 개발자"/><meta data-react-helmet="true" property="og:title" content="유지보수를 위해 문서 보다 테스트 코드를 작성하자"/><meta data-react-helmet="true" property="og:description" content="직각어깨를 꿈꾸는 개발자"/><meta data-react-helmet="true" property="og:type" content="website"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=4a9773549091c227cd2eb82ccd9c5e3a" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=4a9773549091c227cd2eb82ccd9c5e3a"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script data-gatsby="web-vitals-polyfill">
            !function(){var e,t,n,i,r={passive:!0,capture:!0},a=new Date,o=function(){i=[],t=-1,e=null,f(addEventListener)},c=function(i,r){e||(e=r,t=i,n=new Date,f(removeEventListener),u())},u=function(){if(t>=0&&t<n-a){var r={entryType:"first-input",name:e.type,target:e.target,cancelable:e.cancelable,startTime:e.timeStamp,processingStart:e.timeStamp+t};i.forEach((function(e){e(r)})),i=[]}},s=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){c(e,t),a()},i=function(){a()},a=function(){removeEventListener("pointerup",n,r),removeEventListener("pointercancel",i,r)};addEventListener("pointerup",n,r),addEventListener("pointercancel",i,r)}(t,e):c(t,e)}},f=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,s,r)}))},p="hidden"===document.visibilityState?0:1/0;addEventListener("visibilitychange",(function e(t){"hidden"===document.visibilityState&&(p=t.timeStamp,removeEventListener("visibilitychange",e,!0))}),!0);o(),self.webVitals={firstInputPolyfill:function(e){i.push(e),u()},resetFirstInputPolyfill:o,get firstHiddenTime(){return p}}}();
          </script><script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>            
              (adsbygoogle = window.adsbygoogle || []).push({
                google_ad_client: "ca-pub-4711551515762404",
                enable_page_level_ads: true
              });
          </script><link as="script" rel="preload" href="/webpack-runtime-64497d164bea53b55ab8.js"/><link as="script" rel="preload" href="/framework-094b0089736b8f621f0d.js"/><link as="script" rel="preload" href="/app-7b0a9d9c8a02f3d5ef04.js"/><link as="script" rel="preload" href="/commons-5bade2ed2558cad4a45d.js"/><link as="script" rel="preload" href="/component---src-pages-markdown-remark-frontmatter-slug-tsx-b578fbfaba7e485ee7df.js"/><link as="fetch" rel="preload" href="/page-data/blog/elegant-objects-ch2-4/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3000541721.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3293771174.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4711551515762404" crossorigin="anonymous"></script></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="window"><div class="window-container"><header class="title-bar"><a class="title title-bar-text" href="/">JIGGAG</a><div class="title-bar-controls"><button aria-label="Close"></button></div></header><main class="window-body"><div class="blog-post-container"><div class="blog-post-header"><h3>유지보수를 위해 문서 보다 테스트 코드를 작성하자</h3><h6>2021년 9월 18일</h6></div><div class="blog-post-content"><h2><code>유지보수를 위한 테스트 코드</code></h2>
<h3><code>문서 보다 테스트</code></h3>
<p>문서화는 유지보수에 도움을 주는 요소이다.</p>
<p>이 메서드가 어떤 역할을 하는지 설명이 되어있다면
도메인 지식이나 프로그래밍 언어, 알고리즘 등 얽혀있는 복잡한 코드를
전부 이해하지 않아도 흐름을 이해할 수 있기 때문이다.</p>
<p>그러나 결국 유지보수하는 것은 코드이다.
복잡한 코드를 설명하기 위해 복잡한 문서가 필요하다면
코드가 변경될 때 마다 복잡한 문서를 풀어서 다시 작성하는 일이 반복될 것이다.</p>
<p>이것은 과연 유지보수를 위한 것일까?
오히려 유지보수를 위해 코드 + 문서 작업이 추가되는 것은 아닐까?</p>
<p>복잡하지 않은 코드, 단순하면서 의미가 명확한 코드는 문서가 추가적으로 필요하지 않다.
그러나 메서드, 프로퍼티 네이밍이 명확하지 않다면 (나를 이야기하는 것 같다) 다른 사람에게 이것은 어떤 의미이다라는 것을 전달해주는 문서가 필요해진다.
결국 설계가 제대로 되지 않았기 때문에 문서화가 불필요하게 작성되고 있다.</p>
<p>한편으로는 복잡한 알고리즘을 요구하는 코드를 작성해야할때 네이밍을 <code>a, b, value...</code> 사용하고 문서를 남기는게 나을까? 생각이 들기도 한다.
그러나 저런 명확하지 않은 네이밍은 결국 작성하고 있는 자신에게도 역할을 헷갈리게 만들고
<code>같은 역할, 의미를 갖는 것이 이미 존재하는데 다시 만들어서 쓰는</code> 악순환을 발견할 수 있다...</p>
<p>최상의 선택이 문서화 할 필요없이 코드 자체가 깔끔한 것이다.</p>
<p>그럼 <code>깔끔한 코드</code>는 무엇일까?
<code>이해하기 쉬운 코드 + 유지보수가 쉬운 코드 + 의미가 명확한 코드</code> 모두 맞는 것 같다.
그리고 <code>오류를 찾기 쉬운 코드</code>라고 생각한다.</p>
<p>모든 것이 매번 새로 작성되는 것이 아니라 유지보수를 더 많이 하게 되고 지금 객체지향의 목적도 유지보수를 위한 것이다.
이렇게 수많은 유지보수를 하다보면 오류가 분명 있는데 찾기 어려운 코드가 있다.
예를 들면 <a href="/blog/elegant-objects-ch2-3">이전에 스터디했던 내용 중 <code>가변 객체</code></a> 를 사용한 경우 숨어있어서 찾기 어렵다...</p>
<p>오류를 찾기 쉬우려면 어떻게 해야할까?
무언가 원래 의도와 다르게 동작하고 있음을 빨리 캐치해야하는데, 이를 가장 쉽게 도와주는 것이 바로 <code>테스트 코드</code> 이다.</p>
<p>가장 작은 단위로 테스트를 하는 의미로 <code>단위테스트</code>를 작성해서 클래스, 메서드, 함수 단위를 테스트하게 된다.</p>
<p>테스트 코드로 그 함수의 역할, 기댓값 등을 미리 확인할 수 있기 때문에
복잡한 문서화보다 오히려 동작하는 코드를 설명하는 가장 좋은 문서가 테스트 코드이다.</p>
<p>다만 테스트 코드를 작성하는 것이 어려운 코드가 있을 수 있다.
그것이 바로 복잡한 깔끔하지 못한 코드이다ㅠㅠ</p>
<hr>
<h3><code>Mock 보다 Fake</code></h3>
<p>클래스, 함수 테스트 코드를 작성할때 <code>Mock</code>을 사용하고는 한다.
테스트하려고 하는 클래스, 함수가 필요로하는 의존 객체를 모킹을 통해 전달하는 것이다.</p>
<pre><code class="language-ts">class TestClass {
	private other: OtherClass;

	constructor(other: OtherClass) {
		this.other = other;
	}

  print() {
    return this.other.name;
  }
}

const mockOther = new OtherClass();
</code></pre>
<p><code>TestClass</code>의 <code>print</code>를 테스트하려고 하는데 <code>OtherClass</code>가 필요하다.
<code>new TestClass(mockOther)</code>처럼 <code>Mock</code>을 만들어서 <code>OtherClass</code>를 대신하게 한다.</p>
<p>그러나 <code>OtherClass</code>가 또 다른 객체에 의존하고 있다면?
모의 객체를 만들기 위해 의존 객체를 만들어야 하고 그 의존 객체를 만들기 위해 의존의 의존 객체를 만들어야하는 연쇄작업 이어진다. (배보다 배꼽이 커진다)</p>
<pre><code class="language-ts">... // 의존의 의존의 의존
const mockAnother = new AnotherClass(...);
const mockOther = new OtherClass(mockAnother);
</code></pre>
<p>그렇기 때문에 모의 객체보다는 페이크 객체를 사용하는 것을 추천한다.
모의 객체와는 다르게 그 객체가 반환하는 것을 <code>Fake</code>로 만들어둔 객체이다.
이렇게 하면 테스트를 더 짧게 만들 수 있기 때문에 유지보수성이 향상된다.</p>
<pre><code class="language-ts">const fakeOther: OtherClass = {
	name: 'fake',
};
</code></pre>
<p><code>new TestClass(mockOther)</code>처럼 모의 객체를 만들어서 전달하는 것이 아닌
<code>new TestClass(fakeOther)</code> 필요한 객체의 페이크 객체를 바로 전달하여 사용할 수 있게 되었다.
(이게 내용이 헷갈리기 시작한다😱 Fake랑 Stub의 차이가 명확하게 보이지 않는다... Fake, Mock, Stub을 구분해서 만들어줄 수 있어야하겠다!)</p>
<p>모킹을 이용하면 단위테스트가 쉽게 깨질 수 있다!
실제로 테스트하려고 하는 대상이 변경된 것이 아니라면 단위테스트가 실패하면 안된다.
<code>TestClass</code>를 테스트하려고 했는데 <code>OtherClass</code>의 무언가가 변경되었다고 <code>TestClass</code>의 테스트가 실패하면 안되는 것이다.</p>
<p>하지만 모킹은 <code>TestClass</code>와 <code>OtherClass</code>를 결합한 형태이기 때문에 단위테스트가 실패할 수 밖에 없다.</p>
<pre><code class="language-ts">// 예를 들어 아래와 같은 OtherClass의 mock을 이용해 TestClass의 print를 테스트하고 있었다
class OtherClass {
	private name: string;

	constructor(name: string) {
		this.name = name;
	}
}

const mockOther = new OtherClass("mock");
expect(new TestClass(mockOther).print()).toBe("mock");

// 이때 OtherClass name을 아래처럼 변경한 경우 mock이 변경되면서 테스트를 실패하게 된다
class OtherClass {
	private name: string;

	constructor(name: string) {
		this.name = `[Other]${name}`;
	}
}
</code></pre>
<p>의존하고 있는 모의 객체가 예전과 다르게 상태가 변경되었거나 생성되지 않았을 수 있기 때문이다.
모킹은 <code>클래스 구현과 관련된 내부 로직을 테스트 코드와 강하게 결합</code>시켜서 오히려 유지보수, 리팩터링을 어렵게 만든다.</p>
<p>모킹 대신 페이크를 이용해 약속된 결과값을 가져와서 테스트 했다면 정말 단순하게 동작한다.</p>
<pre><code class="language-ts">// 위의 예씨처럼 OtherClass의 생성자에서 name이 변경되더라도 fake 객체에서는 테스트가 깨지지 않는다
const fakeOther: OtherClass = {
	name: 'fake',
};
expect(new TestClass(fakeOther).print()).toBe("fake");
</code></pre>
<p>의존 대상이였던 <code>OtherClass</code>의 생성자가 변경되었더라고 <code>fake 객체</code>는 여전히 <code>OtherClass</code>를 반환하고 있을뿐이다.
생성자 인자를 하나를 사용했거나 두개를 사용하는 것은 <code>OtherClass</code> 내부 로직에서 처리할 일이고 이를 호출하는 곳에서는 <code>OtherClass</code>만 있으면 된다.</p>
<p><code>테스트가 코드의 내부 로직 구현에 관여를 하게 되면 오히려 테스트가 복잡해지고 유지보수가 어려워질뿐이다!</code></p>
<hr>
<h3><code>Mock, Fake, Stub</code></h3>
<p><code>Mock Object</code>는 모의 객체를 만들어서 정말 객체 그 자체를 반환한다. 따라서 객체 의존성을 해결해주어야한다.</p>
<p><code>Fake Object</code>는 객체의 <code>Mock</code>보다는 간소화?된 특정 몇몇 상태의 객체를 반환하는 <code>페이크</code>이다.</p>
<p><code>Test Stub</code>은 특정 상태를 하드코딩한 객체 반환한다. 특정 상태로 고정되어 있기 때문에 액션에 따른 테스트가 어렵다.</p>
<p>여러가지 조건에 따라 액션이 제한되고 반환되는 결과값을 테스트하기 위해
각각 조건에 따른 결과값을 하드코딩으로 준비해두고 액션을 주는 테스트를 작성했었다.
(수많은 하드코딩 + 중복된 코드의 화려한 결과물로 2000줄이 되었다... 테스트 코드도 리팩터링이 필요하다는 것을 이때 깨달았다)
당시에는 이게 <code>Mock</code>라고 생각하고 사용했는데 지금 다시보니 <code>Stub</code>인가!</p>
<p><a href="https://stackoverflow.com/questions/346372/whats-the-difference-between-faking-mocking-and-stubbing">참고: Mock, Fake, Stub</a></p>
<hr>
<h3><code>짧은 인터페이스</code></h3>
<p>클래스 하나의 응집도를 높이려면 클래스가 작게 유지되어야하고
클래스를 작게 만들기 위해서는 인터페이스도 작아야한다.
하나의 클래스에서는 여러개의 인터페이스를 구현할 수 있기 때문에 인터페이스는 정말 작아야한다!</p>
<p>하나의 인터페이스에 너무 많은 역할을 담고 있게 하면
그걸 구현하는 클래스에서는 응집도가 떨어질 수 밖에 없고 <code>단일 책임 원칙</code>에 어긋나게 된다.
각각 독립된 함수는 독립된 인터페이스로 구현하도록 정의되어야한다.</p>
<p>하지만 매우 밀접하게 연관된 인터페이스를 각각 독립된 상태로 만들기에는 오히려 너무 분산되는 느낌 아닐까?</p>
<p>그래서 <code>스마트 클래스</code>(공유하는 인터페이스라고 생각한다)를 추가해서 해결할 수 있다.</p>
<pre><code class="language-ts">class Smart {
  private origin: Exchange;
  constructor(origin: Exchange) {
    this.origin = origin;
  }
	toUsd() {
    return this.origin.rate("usd");
  }
  toEur() {
    return this.origin.rate("eur");
  }
}

interface Exchange {
	rate(value: string): string;
  smart(origin: Exchange): Smart;
}

class Exchange {
  rate(value: string) {
    return value;
  }
  smart() {
    return new Smart(this);
  }
}

const smart = new Exchange().smart();
console.log(smart.toUsd()); // usd
console.log(smart.toEur()); // eur
</code></pre>
<p>공통된 로직을 하나의 스마트 클래스로 분리하는 것이다.
<code>Exchange</code> 안에 <code>Smart</code>클래스가 들어가 있는데 이는 공통된 클래스를 인터페이스와 함께 제공하기 위한 것이다.
서로 다른 클래스에서 동일한 기능을 제공하고자 하는데, 공통된 로직을 계속 다시 구현하지 않도록 도와준다. (HOC 같은 느낌?)</p>
<p>스마트 클래스에 계속 추가하게 된다면 이 클래스 자체가 커지게 되지만
인터페이스의 응집도는 높은 상태로 작게 유지할 수 있고
공통적으로 사용하는 것은 스마트 클래스에서 구현해둔 로직을 가져와서 사용할 수 있게 되었다.</p>
<p><code>공통된 기능을 스마트 클래스로 추출하여 코드 중복을 피할 수 있고 인터페이스를 작게 유지할 수 있다</code></p></div></div></main><footer class="footer"><div class="footer-label">©Jiggag, Built with <a href="https://www.gatsbyjs.com">Gatsby</a></div><button>Github</button></footer></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-115373374-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/elegant-objects-ch2-4/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-635a9dfd597478a1f0fa.js"],"app":["/app-7b0a9d9c8a02f3d5ef04.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-1713fa5a79ba6287b581.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-56ac5eb6f68a10947a02.js"],"component---src-pages-markdown-remark-frontmatter-slug-tsx":["/component---src-pages-markdown-remark-frontmatter-slug-tsx-b578fbfaba7e485ee7df.js"],"component---src-pages-using-ssr-tsx":["/component---src-pages-using-ssr-tsx-a3849e895b554ed9c74d.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-2c91f22b06497815d93c.js"],"component---src-templates-using-dsg-tsx":["/component---src-templates-using-dsg-tsx-96c55d73ae3a8c0dec54.js"]};/*]]>*/</script><script src="/polyfill-635a9dfd597478a1f0fa.js" nomodule=""></script><script src="/component---src-pages-markdown-remark-frontmatter-slug-tsx-b578fbfaba7e485ee7df.js" async=""></script><script src="/commons-5bade2ed2558cad4a45d.js" async=""></script><script src="/app-7b0a9d9c8a02f3d5ef04.js" async=""></script><script src="/framework-094b0089736b8f621f0d.js" async=""></script><script src="/webpack-runtime-64497d164bea53b55ab8.js" async=""></script></body></html>